---
title: 'Chapter 12: Intermediate'
permalink: /intermediate-GANs/
---
<style>
@import url('https://fonts.googleapis.com/css?family=Audiowide&display=swap');
@import url('https://fonts.googleapis.com/css?family=Syncopate:700&display=swap');
@import url('https://fonts.googleapis.com/css?family=Nunito&display=swap');
@import url('https://fonts.googleapis.com/css?family=Fredoka+One&display=swap');
@import "../assets/css/tutorial.css";

    html {
      scroll-behavior: smooth;
    }

    .page-nav {
        border-radius: 43px;
        padding: 20px;
        max-width: 20vw;
        border: 7px solid #333333;
        background-color: white;
    }

    .list-group {
        border-radius: 25px;
        background-color: white;
    }

    .list-group-item {
        border:none;
        font-family: 'Nunito', sans-serif;
        font-size: 1.5vw;
    }

    main {
      width: 100%;
      padding: 6vw;
      background-image: url("../assets/images/gans/jungle2.jpg");
      background-repeat: no-repeat;
      background-position: center center;
      background-size: cover;
      background-attachment: fixed;
    }

    article {
        margin-left: 5vw;
        max-width: 80%;
        background-color: white;
        border-radius: 25px;
        padding: 3vw;
        font-size: 1.75vw;
    }

    .list-group-item-action:hover, .list-group-item-action:focus {
        z-index: 1;
        color: #495057;
        text-decoration: none;
        background-color: rgba(247, 103, 103, .6);
    }

    figure {
        text-align: center;
        width: 100%;
        margin-top: 2vw;
        font-family: 'Nunito', sans-serif;
        font-size: 1.25vw;
    }

    p {
        font-family: 'Nunito', sans-serif;
    }


</style>
<main>
    <div id="container">
        <div class="row justify-content-center align-items-start">
            <div class="col-sm-3 page-nav">
                <div class="list-group">
                    <a class="list-group-item list-group-item-action scrollto" href="#gan-is">What is a GAN?</a>
                    <a class="list-group-item list-group-item-action scrollto" href="#gan-history">History of GANs</a>
                    <a class="list-group-item list-group-item-action scrollto" href="#gan-how">How do GANs work?</a>
                    <a class="list-group-item list-group-item-action scrollto" href="#gan-look">Look inside a GAN</a>
                    <a class="list-group-item list-group-item-action scrollto" href="#gan-quiz">Quiz yourself!</a>
                    <a class="list-group-item list-group-item-action scrollto" href="#mission">Play with GANs!</a>
                </div>
            </div>
            <div class="col-md-9">
                <article>
                    <h1><img src="../assets/images/gans/tiger2.png" style="max-width: 1em;">GANs</h1>
                    <p>In this chapter, we'll learn about Generative Adversarial Networks (GANs), a type of  artificial intelligence that generates, or creates, new content.</p>
                    <h2 id="gan-is">What is a GAN?</h2>
                    <p> The term '<b>GAN</b>' stands for '<b>generative adversarial network</b>'. GANs are made up of two neural networks that are working against each other. These two neural networks are known as the generator and the discriminator. Their relationship is adversarial; essentially, the generator keeps trying to trick the discriminator into thinking the content it creates is real, while the discriminator is trying to catch any differences between what the generator is creating and content that actually exists in the real world. </p>
                    <p>But before we dive too deep into how GANs work, recall what you learned about neural networks in previous chapters. Modeled loosely after the networks in our own brains, neural networks can use regression to establish correlations between pieces of data and use these correlations to accurately classify the data.</p>
                    <p>Our brains classify objects in a similar way. When we look at, touch, taste, hear, or feel something, the set of neurons that have been trained to correctly classify that object are activated and we can accurately identify what the object is. Just like neural networks, our brains have been trained to do this - since childhood, in fact! When you were a toddler, you probably couldn't classify a cat when seeing it for the first time. But after adults repeatedly told you what this furry animal was, your brain learned which neurons to light up to correctly identify the animal as a cat. </p>
                    <figure>
                        <img src="../assets/images/gans/classification.png" style="max-width: 100%;">
                        <figcaption>A neural network classifying a cat</figcaption> <!-- https://becominghuman.ai/building-an-image-classifier-using-deep-learning-in-python-totally-from-a-beginners-perspective-be8dbaf22dd8 -->
                    </figure>
                    <p> The important difference between regular neural networks and GANs is that neural networks <b>classify</b> and GANs <b>generate</b>. For example, even if you can identify a song playing on the radio, can you sing it perfectly? Probably not! GANs are the next evolution of neural networks because they are able to generate new content that didn't exist previously. And they can create some pretty cool things! Let's look at some examples of things that GANs can generate.</p>
                    <figure>
                        <img src="../assets/images/gans/fake_people.png" style="max-width: 100%;">
                        <figcaption>None of these people are real!</figcaption> <!-- https://machinelearningmastery.com/impressive-applications-of-generative-adversarial-networks/ -->
                    </figure>
                    
                    <div class="viz" style="width:100%; font-size:80%; text-align:center">
                      <video loop="" muted="" autoplay="" controls="">
                        <source src="../assets/images/gans/Samsung_heads.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                      </video>
                      <!--Image credit: compiled from [Egor Zakharov].(21 May 2019) <a href="https://www.youtube.com/watch?v=p1b5aiTrGzY">
                        "Few-Shot Adversarial Learning of Realistic Neural Talking Head Models"--> GANs made these pictures and paintings talk!</a>
                    </div>

                    <h3>text</h3>

                    <figure>
                    <iframe scrolling="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/playlists/246633991&amp;color=ff5500&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false" width="100%" height="450" frameborder="0"><!-- react-text: 56 -->This was supposed to display an embedded <!-- /react-text --><a href="https://soundcloud.com/deepjazz-ai/sets">SoundCloud</a><!-- react-text: 58 --> app. Your browser does not support iframes and/or SoundCloud is blocked by your internet provider.<!-- /react-text --></iframe>
                    <figcaption>All of this music was generated by a GAN! Can you tell it apart from real Bach music?</figcaption>
                    </figure>

                    <h2 id="gan-history">History of GANs</h2>
                    <p>The original idea for GANs was published in 2014 by Ian Goodfellow, who is still widely considered to be the father of GANs. The 2014 paper laid out the basic framework for GANs, but since then, many improvements to the model have been made.  A 2015 paper introduced a class of convolutional network (CNN) called DCGANs (deep convolutional GANs), which use deep convolutional neural networks in its architecture instead of regular neural networks, and this became the new baseline for all GAN related applications. Further improvements in 2016 and 2017 improved training stability and prevented mode collapse, a condition in which the generator essentially breaks down. Improvements to image quality and detail were also made in 2017 and 2018, which is why the GAN produced images that we see today are much better than images produced a few years ago.</p>

                    <figure>
                        <img src="../assets/images/gans/GAN_progress.png" style="max-width: 100%;">
                        <figcaption>GANs have gotten a lot better over the past few years!</figcaption>
                    </figure>
                    
                    <figure>
                        <div style="zoom: 0.75">
                          <div class="container">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="main-timeline4">
                                        <div class="timeline">
                                            <text class="timeline-content">
                                                <span class="year">2014</span>
                                                <div class="inner-content">
                                                    <text class="title">Generative Adversarial Nets</a></text>
                                                    <p class="description">
                                                    The original GAN
                                                    </p>
                                                    <br>
                                                    <text class="title">Conditional Generative Adversarial Nets</a></text>
                                                    <p class="description">
                                                    Directing generation with labeled data
                                                    </p>
                                                </div>
                                            </text>
                                        </div>
                                        <div class="timeline">
                                            <text class="timeline-content">
                                                <span class="year">2015</span>
                                                <div class="inner-content">
                                                    <text class="title">Deep Convolutional Generative Adversarial Networks</a></text>
                                                    <p class="description">
                                                        Improvements to the original GAN architecture make DCGAN the new baseline
                                                    </p>
                                                </div>
                                            </text>
                                        </div>
                                        <div class="timeline">
                                            <text class="timeline-content">
                                                <span class="year">2016</span>
                                                <div class="inner-content">
                                                    <text class="title">InfoGAN</a></text>
                                                    <p class="description">
                                                        Encoding meaningful features to make GANs interpretable
                                                    </p>
                                                    <br>
                                                    <text class="title">Improved Techniques for Training GANs</a></text>
                                                    <p class="description">
                                                        Methods improve training stability and encourage convergence
                                                    </p>
                                                </div>
                                            </text>
                                        </div>
                                        <div class="timeline">
                                            <text class="timeline-content">
                                                <span class="year">2017</span>
                                                <div class="inner-content">
                                                    <text class="title">Progressive Growing of GANs</a></text>
                                                    <p class="description">
                                                        Adding layers as training progresses enables modeling of increasingly fine details
                                                    </p>
                                                </div>
                                            </text>
                                        </div>
                                        <div class="timeline">
                                            <text class="timeline-content">
                                                <span class="year">2018</span>
                                                <div class="inner-content">
                                                    <text class="title">Self-Attention GAN</a></text>
                                                    <p class="description">
                                                        Incorporating attention improves image generation quality
                                                    </p>
                                                </div>
                                            </text>
                                        </div>
                                        <div class="timeline">
                                            <text class="timeline-content">
                                                <span class="year">2019</span>
                                                <div class="inner-content">
                                                    <text class="title">Lipschitz GANs</a></text>
                                                    <p class="description">
                                                      Lipschitz constraint guarantees the existence and uniqueness of the optimal discriminative function
                                                    </p>
                                                </div>
                                            </text>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <figcaption>A brief history of GAN development</figcaption>
                    </figure>
                    <h2 id="gan-how">How do GANs work?</h2>
                    <p> You probably know that your own brain can generate a whole manner of things - songs, tastes, smells, feelings, and images. For example, even if you haven't heard a certain song in a while, you can probably sing it from memory. Similar to classification, this is also a learned behavior. Through singing this song over and over again and receiving feedback on the accuracy of your singing, both from other people and from comparing your singing to the real tune, your brain is now more aware of which neurons to activate to sing this song correctly. </p>
                    <p> GANs are based off of this process. As we mentioned in the first section, GANS are made up of two adversarial neural networks called the generator and the discriminator. A discriminator is essentially just a normal neural network that classifies objects, similar to the neural networks you've learned about before. Generators are the opposite! The generator is trying to create content that seems convincing enough to fool the discriminator into classifying it as 'real'.</p> 
                    <p> How does the generator learn how to do this? Well, it's pretty similar to how your own brain learns! At first, the generator has no idea what it's doing, and it activates random neurons to generate an object. It then passes this object to the discriminator, which provides the generator with feedback on its object - in other words, it's telling the generator how close its generated object was to something that the discriminator would accept. With the feedback from the discriminator, the generator doesn't have to randomly guess which neurons to light up anymore. It can now take a more educated guess, and in this constant process of trying to fool the discriminator and receiving feedback, the generator eventually gets very good at creating these objects and knows exactly which neurons to light up to get an object past the discriminator!</p>
                    <p>Let's simplify things a bit with an example. </p>
                    <img src="../assets/images/gans/counterfeit.png" style="max-width: 100%;">
                    <p>The generator is like a counterfeiter. A counterfeiter makes fake money to try to fool people into thinking it's real.</p>
                    <figure>
                        <img src="../assets/images/gans/fake_money.png" style="width: 35%;">
                        <figcaption>Fake money</figcaption>
                    </figure>
                    <p>The discriminator is like the police. The police can compare fake money from the counterfeiter to real money from the bank and tell the difference.</p>
                    <figure>
                        <img src="../assets/images/gans/fake_money.png" style="width: 35%;">
                        <img src="../assets/images/gans/compare_arrows.png" style="width: 10%;">
                        <img src="../assets/images/gans/real_money.png" style="width: 35%;">
                        <figcaption>How does the fake money compare to the real money?</figcaption>
                    </figure>
                    <p>The counterfeiter learns from its past mistakes and improves its fake money to look even more real.</p>
                     <figure>
                        <img src="../assets/images/gans/improved_fake.png" style="width: 35%;">
                        <figcaption>Does this look like real money yet?</figcaption>
                    </figure>
                    <p>To make sure that the counterfeiters don't get away with making fake money, the police have to get even better at telling the difference between fake money and real money from the bank.</p>

                    <h2 id="gan-look">Look inside a GAN</h2>
                    <p> Recall that a neural network is made up of many layers. Each of these layers is composed of units of neurons. A trained neural network knows which units of neurons in which layers it needs to activate to correctly classify an object.</p>
                    <p> The generator in a GAN works similarly to this! By activating units of neurons within each layer and trying to get the resulting object past the discriminator, it learns exactly which units of neurons in specific layers it needs to activate to create an object good enough to fool the discriminator.</p>
                    <p> Let's think for a minute about how computers create unique content. Traditionally, computers have been able to create unique objects in two different ways:</p>
                    <ul>
                      <li>A computer could <i>compose</i> an object out of other objects that it already knows</li>
                      <li>A computer could <i>memorize</i> the contents of an object and recreate one just like it</li>
                    </ul>  
                    <p> Let's stop and ask ourselves: do GANs uniquely <i>compose</i> its objects or are they simply <i>memorizing</i> the contents of objects and recreating similar ones? Well, it turns out that GANs have actually learned some elements of <i>composition</i>. In other words, the units of neurons and layers that make up the generator can recognize specific parts of an object and learn how to generate just those specific parts!</p>
                    
                    <style>
                        .show-unit {
                          overflow-x: auto;
                        }
                        .show-unit img {
                          max-height: 80px;
                        }
                        .explain-unit {
                          text-align: center;
                          margin-bottom: 10px;
                        }
                    </style>

                    <div class="show-unit">
                      <img src="../assets/images/gans/unit-365.jpg">
                    </div>
                    <div class="explain-unit">
                      Unit 365 of a church GAN draws trees.<!--(<a href="#ref_karras">T. Karras, et al, 2018</a>)--> 
                    </div>

                    <div class="show-unit">
                      <img src="../assets/images/gans/unit-43.jpg">
                    </div>
                    <div class="explain-unit">
                      Unit 43 of the church GAN draws domes.
                    </div>

                    <div class="show-unit">
                      <img src="../assets/images/gans/unit-14.jpg">
                    </div>
                    <div class="explain-unit">
                      Unit 14 of the church GAN draws grass.
                    </div>

                    <div class="show-unit">
                      <img src="../assets/images/gans/unit-276.jpg">
                    </div>
                    <div class="explain-unit">
                      Unit 276 of the church GAN draws towers.
                    </div>
                    
                    <p> This is pretty interesting because it means that the types of neurons a GAN trains depends on the type of object it learns to generate. Let's look at an example:</p>
                    <figure>
                        <img src="../assets/images/gans/scene-dissection.png" style="width: 100%;">
                        <figcaption>GANs learning to draw different types of images</figcaption>
                    </figure>
                    <p> Let's look closely at this image. There are four GANs learning to draw four different types of images. From top to bottom, these images are: a conference room, a dining room, a kitchen, and a church/outdoor scene. If we look closely at the right side of the image, we see that the GAN has broken up each of these scenes into separate parts. This means that it has assigned specific units of neurons to draw each of these parts. For example, in the conference room scene (top left), look carefully at the graph in the top right of the picture. Here, the GAN has assigned different units of neurons to draw this scene. There are neurons that know how to draw people, swivel chairs, monitors, and lots of other items that the GAN identified in the scene.</p>
                    <p> But in the kitchen scene, the GAN has identified different types of objects! There are stove neurons, cabinet neurons, and refrigerator neurons. What does this mean? Well, it means that the neurons that a GAN learns depend on the type of scene it learns to draw. A swivel chair neuron appears when learning conference rooms, and a stove neuron appears when drawing kitchens. This makes sense because if you were trying to draw a picture of a kitchen, the neurons in your brain for drawing a swivel chair would probably not activate. Your knowledge of <i>composition</i> allows you to realize that when drawing a kitchen, a swivel chair would not be one of the components that you need. GANs can acquire a basic idea of this information as well! </p>

                    <h2 id="gan-quiz">Quiz yourself!</h2>
                    <script src = "../main.js"></script>
                    <body>
                        <form id = "quiz" name = "quiz">
                            <p> What does the term <b>GAN</b>' stand for?</p>
                            <input id = "textbox" type = "text" name = "question1">

                            <p>In what year was the original idea for GANs published?</p>
                            <input type = "radio" id = "mc" name = "question2" value = "2012">2012<br>
                            <input type = "radio" id = "mc" name = "question2" value = "2014">2014<br>
                            <input type = "radio" id = "mc" name = "question2" value = "2016">2016<br>
                            <input type = "radio" id = "mc" name = "question2" value = "2018">2018<br>

                            <p>Choose the true statement about neural networks and GANs.</p>

                            <input type = "radio" id = "mc" name = "question3" value = "Neural networks and GANs both classify.">Neural networks and GANs both classify.<br>
                            <input type = "radio" id = "mc" name = "question3" value = "Neural networks classify and GANs generate.">Neural networks classify and GANs generate.<br>
                            <input type = "radio" id = "mc" name = "question3" value = "Neural networks generate and GANs classify.">Neural networks generate and GANs classify.<br>
                            <input type = "radio" id = "mc" name = "question3" value = "Neural networks and GANs both generate.">Neural networks and GANs both generate.<br>

                            <p>A neuron in a GAN has learned to recognize rugs. Which set of images was it probably trained on?</p>

                            <input type = "radio" id = "mc" name = "question4" value = "kitchen">&nbsp&nbsp<img src="../assets/images/quiz/kitchen.png" style="max-width: 100%;"> &nbsp Images of kitchens <br><br>
                            <input type = "radio" id = "mc" name = "question4" value = "livingroom">&nbsp&nbsp<img src="../assets/images/quiz/livingroom.jpg" style="max-width: 100%;">&nbsp Images of living rooms <br><br>
                            <input type = "radio" id = "mc" name = "question4" value = "deck">&nbsp&nbsp<img src="../assets/images/quiz/deck.PNG" style="max-width: 100%;">&nbsp Images of decks <br><br>
                            <input type = "radio" id = "mc" name = "question4" value = "backyard">&nbsp&nbsp<img src="../assets/images/quiz/backyard.JPG" style="max-width: 100%;">&nbsp Images of backyards <br><br>


                            <br>
                            <input id = "button" type = "button" value = "Submit" onclick = "check();">

                        </form>

                        <div id = "after_submit">
                            <p id = "number_correct"></p>
                        </div>
                        </html>

                    </body>

                    <h2 id="mission">Play with GANs!</h2>

                    <p>Let's have some fun! Select one of the images below to play games with GANs!</p>
                    <br>
                    <div id="GAN_fun" class="row">
                      <div class="col container">
                        <a id="fun1" href="https://ganimals.media.mit.edu/breed_em">
                              <img class="GAN_fun" src="../assets/images/gans/turtledog.png">
                              <div class="overlay">
                                <p class="img__description"><b>GANIMALS</b><br>Breed funky hybrid animals!</p>
                            </div>
                          </a>
                      </div>
                        <div class="col container">
                          <a id="fun2" class="GAN_fun" href="https://affinelayer.com/pixsrv/">
                              <img class="GAN_fun" src="../assets/images/gans/GAN-cat.png">
                              <div class="overlay">
                                <p class="img__description"><b>EDGES2...</b> cats, shoes, buildings and more from line drawings</p>
                              </div>
                          </a>
                      </div>
                        <div class="w-100" style="padding-top: 30px;"></div>
                        <div class="col container">
                        <a id="fun3" href="https://www.thispersondoesnotexist.com/">
                          <img class="GAN_fun" src="../assets/images/gans/fake-person.png">
                            <div class="overlay">
                                <p class="img__description"><b>THIS PERSON DOES NOT EXIST</b><br>so many faces - and none of them are real</p>
                            </div>
                      </a>

                        </div>
                      <div class="col container">
                        <a id="fun4" href="https://mitmedialab.github.io/GAN-play/">
                          <img class="GAN_fun" src="../assets/images/gans/pix2pix.png">
                            <div class="overlay">
                                <p class="img__description"><b>GANPLAY</b><br>Play with all sorts of fun GANs!</p>
                            </div>
                      </a>
                          </div>
                    </div>                 
                </article>
            </div>
        </div>
    </div>
</main>
